import{bp as z,c9 as G,bt as R,ca as J}from"./index-8345d350.js";var K=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/;function Z(e,n){if(z(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||G(e)?!0:X.test(e)||!K.test(e)||n!=null&&e in Object(n)}var Y="Expected a function";function E(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new TypeError(Y);var t=function(){var r=arguments,i=n?n.apply(this,r):r[0],f=t.cache;if(f.has(i))return f.get(i);var s=e.apply(this,r);return t.cache=f.set(i,s)||f,s};return t.cache=new(E.Cache||R),t}E.Cache=R;var q=500;function H(e){var n=E(e,function(r){return t.size===q&&t.clear(),r}),t=n.cache;return n}var Q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,W=/\\(\\)?/g,V=H(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(Q,function(t,r,i,f){n.push(i?f.replace(W,"$1"):r||t)}),n});const nn=V;function tn(e,n){return z(e)?e:Z(e,n)?[e]:nn(J(e))}var rn=1/0;function en(e){if(typeof e=="string"||G(e))return e;var n=e+"";return n=="0"&&1/e==-rn?"-0":n}function on(e,n){n=tn(n,e);for(var t=0,r=n.length;e!=null&&t<r;)e=e[en(n[t++])];return t&&t==r?e:void 0}function yn(e,n,t){var r=e==null?void 0:on(e,n);return r===void 0?t:r}var p;(function(e){e[e.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",e[e.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",e[e.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(p||(p={}));var sn=function(){function e(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return e.prototype.addTypeMetadata=function(n){this._typeMetadatas.has(n.target)||this._typeMetadatas.set(n.target,new Map),this._typeMetadatas.get(n.target).set(n.propertyName,n)},e.prototype.addTransformMetadata=function(n){this._transformMetadatas.has(n.target)||this._transformMetadatas.set(n.target,new Map),this._transformMetadatas.get(n.target).has(n.propertyName)||this._transformMetadatas.get(n.target).set(n.propertyName,[]),this._transformMetadatas.get(n.target).get(n.propertyName).push(n)},e.prototype.addExposeMetadata=function(n){this._exposeMetadatas.has(n.target)||this._exposeMetadatas.set(n.target,new Map),this._exposeMetadatas.get(n.target).set(n.propertyName,n)},e.prototype.addExcludeMetadata=function(n){this._excludeMetadatas.has(n.target)||this._excludeMetadatas.set(n.target,new Map),this._excludeMetadatas.get(n.target).set(n.propertyName,n)},e.prototype.findTransformMetadatas=function(n,t,r){return this.findMetadatas(this._transformMetadatas,n,t).filter(function(i){return!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?r===p.CLASS_TO_CLASS||r===p.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?r===p.CLASS_TO_PLAIN:!0})},e.prototype.findExcludeMetadata=function(n,t){return this.findMetadata(this._excludeMetadatas,n,t)},e.prototype.findExposeMetadata=function(n,t){return this.findMetadata(this._exposeMetadatas,n,t)},e.prototype.findExposeMetadataByCustomName=function(n,t){return this.getExposedMetadatas(n).find(function(r){return r.options&&r.options.name===t})},e.prototype.findTypeMetadata=function(n,t){return this.findMetadata(this._typeMetadatas,n,t)},e.prototype.getStrategy=function(n){var t=this._excludeMetadatas.get(n),r=t&&t.get(void 0),i=this._exposeMetadatas.get(n),f=i&&i.get(void 0);return r&&f||!r&&!f?"none":r?"excludeAll":"exposeAll"},e.prototype.getExposedMetadatas=function(n){return this.getMetadata(this._exposeMetadatas,n)},e.prototype.getExcludedMetadatas=function(n){return this.getMetadata(this._excludeMetadatas,n)},e.prototype.getExposedProperties=function(n,t){return this.getExposedMetadatas(n).filter(function(r){return!r.options||r.options.toClassOnly===!0&&r.options.toPlainOnly===!0?!0:r.options.toClassOnly===!0?t===p.CLASS_TO_CLASS||t===p.PLAIN_TO_CLASS:r.options.toPlainOnly===!0?t===p.CLASS_TO_PLAIN:!0}).map(function(r){return r.propertyName})},e.prototype.getExcludedProperties=function(n,t){return this.getExcludedMetadatas(n).filter(function(r){return!r.options||r.options.toClassOnly===!0&&r.options.toPlainOnly===!0?!0:r.options.toClassOnly===!0?t===p.CLASS_TO_CLASS||t===p.PLAIN_TO_CLASS:r.options.toPlainOnly===!0?t===p.CLASS_TO_PLAIN:!0}).map(function(r){return r.propertyName})},e.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},e.prototype.getMetadata=function(n,t){var r=n.get(t),i;r&&(i=Array.from(r.values()).filter(function(S){return S.propertyName!==void 0}));for(var f=[],s=0,u=this.getAncestors(t);s<u.length;s++){var a=u[s],O=n.get(a);if(O){var c=Array.from(O.values()).filter(function(S){return S.propertyName!==void 0});f.push.apply(f,c)}}return f.concat(i||[])},e.prototype.findMetadata=function(n,t,r){var i=n.get(t);if(i){var f=i.get(r);if(f)return f}for(var s=0,u=this.getAncestors(t);s<u.length;s++){var a=u[s],O=n.get(a);if(O){var c=O.get(r);if(c)return c}}},e.prototype.findMetadatas=function(n,t,r){var i=n.get(t),f;i&&(f=i.get(r));for(var s=[],u=0,a=this.getAncestors(t);u<a.length;u++){var O=a[u],c=n.get(O);c&&c.has(r)&&s.push.apply(s,c.get(r))}return s.slice().reverse().concat((f||[]).slice().reverse())},e.prototype.getAncestors=function(n){if(!n)return[];if(!this._ancestorsMap.has(n)){for(var t=[],r=Object.getPrototypeOf(n.prototype.constructor);typeof r.prototype<"u";r=Object.getPrototypeOf(r.prototype.constructor))t.push(r);this._ancestorsMap.set(n,t)}return this._ancestorsMap.get(n)},e}(),L=new sn;function fn(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self}function pn(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var B=globalThis&&globalThis.__spreadArray||function(e,n,t){if(t||arguments.length===2)for(var r=0,i=n.length,f;r<i;r++)(f||!(r in n))&&(f||(f=Array.prototype.slice.call(n,0,r)),f[r]=n[r]);return e.concat(f||Array.prototype.slice.call(n))};function un(e){var n=new e;return!(n instanceof Set)&&!("push"in n)?[]:n}var T=function(){function e(n,t){this.transformationType=n,this.options=t,this.recursionStack=new Set}return e.prototype.transform=function(n,t,r,i,f,s){var u=this;if(s===void 0&&(s=0),Array.isArray(t)||t instanceof Set){var a=i&&this.transformationType===p.PLAIN_TO_CLASS?un(i):[];return t.forEach(function(y,m){var M=n?n[m]:void 0;if(!u.options.enableCircularCheck||!u.isCircular(y)){var A=void 0;if(typeof r!="function"&&r&&r.options&&r.options.discriminator&&r.options.discriminator.property&&r.options.discriminator.subTypes){if(u.transformationType===p.PLAIN_TO_CLASS){A=r.options.discriminator.subTypes.find(function(_){return _.name===y[r.options.discriminator.property]});var g={newObject:a,object:y,property:void 0},d=r.typeFunction(g);A===void 0?A=d:A=A.value,r.options.keepDiscriminatorProperty||delete y[r.options.discriminator.property]}u.transformationType===p.CLASS_TO_CLASS&&(A=y.constructor),u.transformationType===p.CLASS_TO_PLAIN&&(y[r.options.discriminator.property]=r.options.discriminator.subTypes.find(function(_){return _.value===y.constructor}).name)}else A=r;var C=u.transform(M,y,A,void 0,y instanceof Map,s+1);a instanceof Set?a.add(C):a.push(C)}else u.transformationType===p.CLASS_TO_CLASS&&(a instanceof Set?a.add(y):a.push(y))}),a}else{if(r===String&&!f)return t==null?t:String(t);if(r===Number&&!f)return t==null?t:Number(t);if(r===Boolean&&!f)return t==null?t:!!t;if((r===Date||t instanceof Date)&&!f)return t instanceof Date?new Date(t.valueOf()):t==null?t:new Date(t);if(fn().Buffer&&(r===Buffer||t instanceof Buffer)&&!f)return t==null?t:Buffer.from(t);if(pn(t)&&!f)return new Promise(function(y,m){t.then(function(M){return y(u.transform(void 0,M,r,void 0,void 0,s+1))},m)});if(!f&&t!==null&&typeof t=="object"&&typeof t.then=="function")return t;if(typeof t=="object"&&t!==null){!r&&t.constructor!==Object&&(!Array.isArray(t)&&t.constructor===Array||(r=t.constructor)),!r&&n&&(r=n.constructor),this.options.enableCircularCheck&&this.recursionStack.add(t);var O=this.getKeys(r,t,f),c=n||{};!n&&(this.transformationType===p.PLAIN_TO_CLASS||this.transformationType===p.CLASS_TO_CLASS)&&(f?c=new Map:r?c=new r:c={});for(var S=function(y){if(y==="__proto__"||y==="constructor")return"continue";var m=y,M=y,A=y;if(!o.options.ignoreDecorators&&r){if(o.transformationType===p.PLAIN_TO_CLASS){var g=L.findExposeMetadataByCustomName(r,y);g&&(A=g.propertyName,M=g.propertyName)}else if(o.transformationType===p.CLASS_TO_PLAIN||o.transformationType===p.CLASS_TO_CLASS){var g=L.findExposeMetadata(r,y);g&&g.options&&g.options.name&&(M=g.options.name)}}var d=void 0;o.transformationType===p.PLAIN_TO_CLASS?d=t[m]:t instanceof Map?d=t.get(m):t[m]instanceof Function?d=t[m]():d=t[m];var C=void 0,_=d instanceof Map;if(r&&f)C=r;else if(r){var l=L.findTypeMetadata(r,A);if(l){var $={newObject:c,object:t,property:A},F=l.typeFunction?l.typeFunction($):l.reflectedType;l.options&&l.options.discriminator&&l.options.discriminator.property&&l.options.discriminator.subTypes?t[m]instanceof Array?C=l:(o.transformationType===p.PLAIN_TO_CLASS&&(C=l.options.discriminator.subTypes.find(function(P){if(d&&d instanceof Object&&l.options.discriminator.property in d)return P.name===d[l.options.discriminator.property]}),C===void 0?C=F:C=C.value,l.options.keepDiscriminatorProperty||d&&d instanceof Object&&l.options.discriminator.property in d&&delete d[l.options.discriminator.property]),o.transformationType===p.CLASS_TO_CLASS&&(C=d.constructor),o.transformationType===p.CLASS_TO_PLAIN&&d&&(d[l.options.discriminator.property]=l.options.discriminator.subTypes.find(function(P){return P.value===d.constructor}).name)):C=F,_=_||l.reflectedType===Map}else if(o.options.targetMaps)o.options.targetMaps.filter(function(P){return P.target===r&&!!P.properties[A]}).forEach(function(P){return C=P.properties[A]});else if(o.options.enableImplicitConversion&&o.transformationType===p.PLAIN_TO_CLASS){var w=Reflect.getMetadata("design:type",r.prototype,A);w&&(C=w)}}var D=Array.isArray(t[m])?o.getReflectedType(r,A):void 0,j=n?n[m]:void 0;if(c.constructor.prototype){var k=Object.getOwnPropertyDescriptor(c.constructor.prototype,M);if((o.transformationType===p.PLAIN_TO_CLASS||o.transformationType===p.CLASS_TO_CLASS)&&(k&&!k.set||c[M]instanceof Function))return"continue"}if(!o.options.enableCircularCheck||!o.isCircular(d)){var v=o.transformationType===p.PLAIN_TO_CLASS?M:y,h=void 0;o.transformationType===p.CLASS_TO_PLAIN?(h=t[v],h=o.applyCustomTransformations(h,r,v,t,o.transformationType),h=t[v]===h?d:h,h=o.transform(j,h,C,D,_,s+1)):d===void 0&&o.options.exposeDefaultValues?h=c[M]:(h=o.transform(j,d,C,D,_,s+1),h=o.applyCustomTransformations(h,r,v,t,o.transformationType)),(h!==void 0||o.options.exposeUnsetFields)&&(c instanceof Map?c.set(M,h):c[M]=h)}else if(o.transformationType===p.CLASS_TO_CLASS){var h=d;h=o.applyCustomTransformations(h,r,y,t,o.transformationType),(h!==void 0||o.options.exposeUnsetFields)&&(c instanceof Map?c.set(M,h):c[M]=h)}},o=this,I=0,b=O;I<b.length;I++){var U=b[I];S(U)}return this.options.enableCircularCheck&&this.recursionStack.delete(t),c}else return t}},e.prototype.applyCustomTransformations=function(n,t,r,i,f){var s=this,u=L.findTransformMetadatas(t,r,this.transformationType);return this.options.version!==void 0&&(u=u.filter(function(a){return a.options?s.checkVersion(a.options.since,a.options.until):!0})),this.options.groups&&this.options.groups.length?u=u.filter(function(a){return a.options?s.checkGroups(a.options.groups):!0}):u=u.filter(function(a){return!a.options||!a.options.groups||!a.options.groups.length}),u.forEach(function(a){n=a.transformFn({value:n,key:r,obj:i,type:f,options:s.options})}),n},e.prototype.isCircular=function(n){return this.recursionStack.has(n)},e.prototype.getReflectedType=function(n,t){if(n){var r=L.findTypeMetadata(n,t);return r?r.reflectedType:void 0}},e.prototype.getKeys=function(n,t,r){var i=this,f=L.getStrategy(n);f==="none"&&(f=this.options.strategy||"exposeAll");var s=[];if((f==="exposeAll"||r)&&(t instanceof Map?s=Array.from(t.keys()):s=Object.keys(t)),r)return s;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&n){var u=L.getExposedProperties(n,this.transformationType),a=L.getExcludedProperties(n,this.transformationType);s=B(B([],u,!0),a,!0)}if(!this.options.ignoreDecorators&&n){var u=L.getExposedProperties(n,this.transformationType);this.transformationType===p.PLAIN_TO_CLASS&&(u=u.map(function(S){var o=L.findExposeMetadata(n,S);return o&&o.options&&o.options.name?o.options.name:S})),this.options.excludeExtraneousValues?s=u:s=s.concat(u);var O=L.getExcludedProperties(n,this.transformationType);O.length>0&&(s=s.filter(function(S){return!O.includes(S)})),this.options.version!==void 0&&(s=s.filter(function(S){var o=L.findExposeMetadata(n,S);return!o||!o.options?!0:i.checkVersion(o.options.since,o.options.until)})),this.options.groups&&this.options.groups.length?s=s.filter(function(S){var o=L.findExposeMetadata(n,S);return!o||!o.options?!0:i.checkGroups(o.options.groups)}):s=s.filter(function(S){var o=L.findExposeMetadata(n,S);return!o||!o.options||!o.options.groups||!o.options.groups.length})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(s=s.filter(function(c){return i.options.excludePrefixes.every(function(S){return c.substr(0,S.length)!==S})})),s=s.filter(function(c,S,o){return o.indexOf(c)===S}),s},e.prototype.checkVersion=function(n,t){var r=!0;return r&&n&&(r=this.options.version>=n),r&&t&&(r=this.options.version<t),r},e.prototype.checkGroups=function(n){return n?this.options.groups.some(function(t){return n.includes(t)}):!0},e}(),N={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},x=globalThis&&globalThis.__assign||function(){return x=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},x.apply(this,arguments)},an=function(){function e(){}return e.prototype.instanceToPlain=function(n,t){var r=new T(p.CLASS_TO_PLAIN,x(x({},N),t));return r.transform(void 0,n,void 0,void 0,void 0,void 0)},e.prototype.classToPlainFromExist=function(n,t,r){var i=new T(p.CLASS_TO_PLAIN,x(x({},N),r));return i.transform(t,n,void 0,void 0,void 0,void 0)},e.prototype.plainToInstance=function(n,t,r){var i=new T(p.PLAIN_TO_CLASS,x(x({},N),r));return i.transform(void 0,t,n,void 0,void 0,void 0)},e.prototype.plainToClassFromExist=function(n,t,r){var i=new T(p.PLAIN_TO_CLASS,x(x({},N),r));return i.transform(n,t,void 0,void 0,void 0,void 0)},e.prototype.instanceToInstance=function(n,t){var r=new T(p.CLASS_TO_CLASS,x(x({},N),t));return r.transform(void 0,n,void 0,void 0,void 0,void 0)},e.prototype.classToClassFromExist=function(n,t,r){var i=new T(p.CLASS_TO_CLASS,x(x({},N),r));return i.transform(t,n,void 0,void 0,void 0,void 0)},e.prototype.serialize=function(n,t){return JSON.stringify(this.instanceToPlain(n,t))},e.prototype.deserialize=function(n,t,r){var i=JSON.parse(t);return this.plainToInstance(n,i,r)},e.prototype.deserializeArray=function(n,t,r){var i=JSON.parse(t);return this.plainToInstance(n,i,r)},e}(),cn=new an;function Sn(e,n,t){return cn.plainToInstance(e,n,t)}export{on as b,tn as c,L as d,yn as g,Z as i,Sn as p,en as t};
