import{c as Q,a as G,d as h,u as X,b as L,e as z,f as Z,h as k,t as ee,g as O,i as de,r as x,j as ue,k as pe,B as te,A as W,o as _,l as C,m as p,n as g,p as e,q as R,w as c,s as M,N as A,v as V,x as i,y as me,F as ne,z as _e,C as se,D as oe,E as ve,G as U,H as fe,U as ae,I as he}from"./index-8345d350.js";import{u as ge,a as xe,N as ye}from"./base-data.service-aad5bd15.js";import{P as we,N as be,A as Ce}from"./Add12Regular-e2e93abf.js";import{p as $e}from"./index-31bc1811.js";import{_ as D,N as T}from"./_plugin-vue_export-helper-8cf4a34d.js";import{N as S,a as ze,b as ke}from"./LayoutContent-af7960e8.js";import{N as K,a as Re}from"./Grid-98fae3d5.js";import"./next-frame-once-7035a838.js";const Ae=Q("p",`
 box-sizing: border-box;
 transition: color .3s var(--n-bezier);
 margin: var(--n-margin);
 font-size: var(--n-font-size);
 line-height: var(--n-line-height);
 color: var(--n-text-color);
`,[G("&:first-child","margin-top: 0;"),G("&:last-child","margin-bottom: 0;")]),Pe=Object.assign(Object.assign({},L.props),{depth:[String,Number]}),Be=h({name:"P",props:Pe,setup(t){const{mergedClsPrefixRef:r,inlineThemeDisabled:n}=X(t),l=L("Typography","-p",Ae,ee,t,r),o=z(()=>{const{depth:m}=t,v=m||"1",{common:{cubicBezierEaseInOut:a},self:{pFontSize:d,pLineHeight:u,pMargin:f,pTextColor:b,[`pTextColor${v}Depth`]:y}}=l.value;return{"--n-bezier":a,"--n-font-size":d,"--n-line-height":u,"--n-margin":f,"--n-text-color":m===void 0?b:y}}),s=n?Z("p",z(()=>`${t.depth||""}`),o,t):void 0;return{mergedClsPrefix:r,cssVars:n?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var t;return(t=this.onRender)===null||t===void 0||t.call(this),k("p",{class:[`${this.mergedClsPrefix}-p`,this.themeClass],style:this.cssVars},this.$slots)}}),Se=Q("text",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[O("strong",`
 font-weight: var(--n-font-weight-strong);
 `),O("italic",{fontStyle:"italic"}),O("underline",{textDecoration:"underline"}),O("code",`
 line-height: 1.4;
 display: inline-block;
 font-family: var(--n-font-famliy-mono);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 box-sizing: border-box;
 padding: .05em .35em 0 .35em;
 border-radius: var(--n-code-border-radius);
 font-size: .9em;
 color: var(--n-code-text-color);
 background-color: var(--n-code-color);
 border: var(--n-code-border);
 `)]),Ne=Object.assign(Object.assign({},L.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),Me=h({name:"Text",props:Ne,setup(t){const{mergedClsPrefixRef:r,inlineThemeDisabled:n}=X(t),l=L("Typography","-text",Se,ee,t,r),o=z(()=>{const{depth:m,type:v}=t,a=v==="default"?m===void 0?"textColor":`textColor${m}Depth`:de("textColor",v),{common:{fontWeightStrong:d,fontFamilyMono:u,cubicBezierEaseInOut:f},self:{codeTextColor:b,codeBorderRadius:y,codeColor:E,codeBorder:ie,[a]:ce}}=l.value;return{"--n-bezier":f,"--n-text-color":ce,"--n-font-weight-strong":d,"--n-font-famliy-mono":u,"--n-code-border-radius":y,"--n-code-text-color":b,"--n-code-color":E,"--n-code-border":ie}}),s=n?Z("text",z(()=>`${t.type[0]}${t.depth||""}`),o,t):void 0;return{mergedClsPrefix:r,compitableTag:ge(t,["as","tag"]),cssVars:n?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var t,r,n;const{mergedClsPrefix:l}=this;(t=this.onRender)===null||t===void 0||t.call(this);const o=[`${l}-text`,this.themeClass,{[`${l}-text--code`]:this.code,[`${l}-text--delete`]:this.delete,[`${l}-text--strong`]:this.strong,[`${l}-text--italic`]:this.italic,[`${l}-text--underline`]:this.underline}],s=(n=(r=this.$slots).default)===null||n===void 0?void 0:n.call(r);return this.code?k("code",{class:o,style:this.cssVars},this.delete?k("del",null,s):s):this.delete?k("del",{class:o,style:this.cssVars},s):k(this.compitableTag||"span",{class:o,style:this.cssVars},s)}}),j=x(0),F=x([]),H=x(),w=x(),J=x(),P=x();function I(){const t=ue();async function r(){const{data:a}=await xe(W.PROGRAMS);F.value=$e(we,a.value)||[]}function n(a){return!w.value||a===null?!1:w.value.id===a}function l(a){var d,u,f;w.value=JSON.parse(JSON.stringify(a)),P.value=JSON.parse(JSON.stringify((d=w.value)==null?void 0:d.actions)),j.value=P.value?P.value.reduce((b,y)=>b+y.duration,0):0,J.value=((u=w.value)==null?void 0:u.id)??void 0,H.value=(f=w.value)==null?void 0:f.description}function o(a){var d,u;a!==null&&a!==""&&(J.value=a,w.value=F.value.find(f=>f.id===a),P.value=(d=w.value)==null?void 0:d.actions,j.value=P.value?P.value.reduce((f,b)=>f+b.duration,0):0,H.value=(u=w.value)==null?void 0:u.description)}function s(){t.push({name:"create-program"}).then()}function m(a){a!==null&&t.push({name:"edit-program",params:{id:a}}).then()}function v(a){a!==null&&te.delete(W.PROGRAM(a)).then(()=>{r()})}return{programs:F,activeProgram:w,activeProgramId:J,programDescription:H,isActive:n,setActive:l,setActiveById:o,sessionPeriod:pe(j),openProgramCreation:s,openProgramEdit:m,deleteProgram:v,fetchPrograms:r}}const Te={class:"main-wrapper"},De=h({__name:"MainDescription",setup(t){const r=x(!1),{programDescription:n}=I();return(l,o)=>(_(),C(ne,null,[p("div",Te,[p("h2",null,g(l.$t("main.title")),1),p("div",null,[p("p",null,g(e(n)),1),e(n)?(_(),R(e(A),{key:0,size:"small",class:"display: span",text:"",quaternary:"",onClick:o[0]||(o[0]=s=>r.value=!0)},{default:c(()=>[M(g(l.$t("main.buttonTitle")),1)]),_:1})):V("",!0)])]),i(e(me),{show:r.value,"onUpdate:show":o[1]||(o[1]=s=>r.value=s),"mask-closable":!0,style:{width:"600px"},title:l.$t("main.title"),"aria-modal":"true",preset:"card"},{default:c(()=>[p("p",null,g(e(n)),1)]),_:1},8,["show","title"])],64))}});const Ie=D(De,[["__scopeId","data-v-8a45608d"]]),Oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ve=p("g",{fill:"none"},[p("path",{d:"M8.628 14.982A1 1 0 0 1 7 14.204V5.797a1 1 0 0 1 1.628-.778l4.723 3.814a1.5 1.5 0 0 1 0 2.334l-4.723 3.815zM8 5.797v8.407l4.723-3.815a.5.5 0 0 0 0-.778L8 5.797z",fill:"currentColor"})],-1),Le=[Ve],Ee=h({name:"CaretRight20Regular",render:function(r,n){return _(),C("svg",Oe,Le)}}),je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Fe=p("g",{fill:"none"},[p("path",{d:"M6.5 7v4a.5.5 0 0 0 1 0V7a.5.5 0 0 0-1 0zM9 6.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5zM10 4h3a.5.5 0 0 1 0 1h-.553l-.752 6.776A2.5 2.5 0 0 1 9.21 14H6.79a2.5 2.5 0 0 1-2.485-2.224L3.552 5H3a.5.5 0 0 1 0-1h3a2 2 0 1 1 4 0zM8 3a1 1 0 0 0-1 1h2a1 1 0 0 0-1-1zM4.559 5l.74 6.666A1.5 1.5 0 0 0 6.79 13h2.42a1.5 1.5 0 0 0 1.49-1.334L11.442 5H4.56z",fill:"currentColor"})],-1),He=[Fe],Je=h({name:"Delete16Regular",render:function(r,n){return _(),C("svg",je,He)}}),We={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Ge=p("g",{fill:"none"},[p("path",{d:"M13.416 2.584c.778.778.778 2.039 0 2.817L6.058 12.76c-.319.32-.719.546-1.156.655l-2.283.57a.498.498 0 0 1-.604-.603l.57-2.283a2.49 2.49 0 0 1 .656-1.156l7.358-7.358a1.992 1.992 0 0 1 2.817 0zM9.894 4.697l-5.949 5.949a1.495 1.495 0 0 0-.393.694l-.369 1.477l1.477-.37c.263-.065.503-.2.694-.392l5.949-5.95l-1.409-1.408zm1.41-1.41l-.705.705l1.408 1.409l.705-.704a.996.996 0 0 0-1.409-1.41z",fill:"currentColor"})],-1),Ue=[Ge],Ke=h({name:"Edit16Regular",render:function(r,n){return _(),C("svg",We,Ue)}}),qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48"},Ye=p("g",{fill:"none"},[p("path",{d:"M17.75 7A3.25 3.25 0 0 1 21 10.25v27.5A3.25 3.25 0 0 1 17.75 41h-5.5A3.25 3.25 0 0 1 9 37.75v-27.5A3.25 3.25 0 0 1 12.25 7h5.5zm18 0A3.25 3.25 0 0 1 39 10.25v27.5A3.25 3.25 0 0 1 35.75 41h-5.5A3.25 3.25 0 0 1 27 37.75v-27.5A3.25 3.25 0 0 1 30.25 7h5.5zm-18 2.5h-5.5a.75.75 0 0 0-.75.75v27.5c0 .414.336.75.75.75h5.5a.75.75 0 0 0 .75-.75v-27.5a.75.75 0 0 0-.75-.75zm18 0h-5.5a.75.75 0 0 0-.75.75v27.5c0 .414.336.75.75.75h5.5a.75.75 0 0 0 .75-.75v-27.5a.75.75 0 0 0-.75-.75z",fill:"currentColor"})],-1),Qe=[Ye],Xe=h({name:"Pause48Regular",render:function(r,n){return _(),C("svg",qe,Qe)}}),Ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},et=p("g",{fill:"none"},[p("path",{d:"M15.5 4a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5h11zm-11-1A1.5 1.5 0 0 0 3 4.5v11A1.5 1.5 0 0 0 4.5 17h11a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 15.5 3h-11z",fill:"currentColor"})],-1),tt=[et],nt=h({name:"Stop20Regular",render:function(r,n){return _(),C("svg",Ze,tt)}});var N=(t=>(t.pause="pause",t.resume="resume",t.run="run",t.stop="stop",t))(N||{});const $=x("stop"),q=x();function re(){const t=({hours:a,minutes:d,seconds:u})=>[k("span",{style:"display: none;"},a),k("span",{style:"display: inline-block; font-weight: bold"},d),":",k("span",{style:"display: inline-block; font-weight: bold"},u)],r=z(()=>$.value==="run"),n=z(()=>$.value==="pause"),l=z(()=>$.value==="resume"),o=z(()=>$.value==="stop");function s(a,d){d!==void 0&&te.get(W.SET_STATE_BY_ID(a,d),{},void 0,"Ошибка при установке статуса").then(()=>{$.value=a,$.value==="stop"&&v()})}function m(a){$.value=a}function v(){var a;(a=q.value)==null||a.reset()}return{state:$,setState:s,isActivated:r,isPaused:n,isResumed:l,isStopped:o,stateEnum:N,renderCountdown:t,handleReset:v,countdown:q,setStateWebsocket:m}}var le=(t=>(t[t.paused=N.pause]="paused",t[t.stopped=N.stop]="stopped",t[t.running=N.run]="running",t))(le||{});const B=x(),Y=x(0),{setStateWebsocket:st}=re(),{setActiveById:ot,isActive:at}=I();function rt(){const t=new WebSocket(_e+"/status");return se(()=>{t.onmessage=function(r){var n,l,o;B.value=JSON.parse(r.data),Y.value=JSON.parse(r.data).elapsed_time,st(le[(n=B.value)==null?void 0:n.program_status]),ot((l=B.value)==null?void 0:l.program_id),at((o=B.value)==null?void 0:o.program_id)}}),{websocketData:B,elapsedTime:Y}}const lt={class:"wrapper-control"},it={class:"title-control"},ct=h({__name:"ControlSystem",setup(t){const{setState:r,isActivated:n,isStopped:l,isPaused:o,isResumed:s,stateEnum:m,renderCountdown:v,countdown:a}=re(),{sessionPeriod:d,activeProgramId:u}=I(),{elapsedTime:f}=rt();return(b,y)=>(_(),C("div",lt,[i(e(A),{disabled:e(u)===void 0&&(!e(n)||e(l)),class:oe(["btn-control",e(o)?"active":""]),onClick:y[0]||(y[0]=E=>e(r)(e(o)?e(m).resume:e(m).pause,e(u)))},{default:c(()=>[i(e(T),{size:"44",color:"#ddd",component:e(Xe)},null,8,["component"])]),_:1},8,["disabled","class"]),p("div",it,[i(e(Be),{type:"default"},{default:c(()=>[M(g(b.$t("control.title")),1)]),_:1}),i(e(Me),{type:e(n)?"error":"default",class:"timer",depth:"3"},{default:c(()=>[i(e(be),{ref_key:"countdown",ref:a,duration:(e(d)-e(f))*1e3,active:!1,render:e(v)},null,8,["duration","render"])]),_:1},8,["type"])]),i(e(A),{disabled:e(u)===void 0,class:"btn-control",onClick:y[1]||(y[1]=E=>e(r)(e(n)||e(o)||e(s)?e(m).stop:e(m).run,e(u)))},{default:c(()=>[i(e(T),{color:e(n)||e(o)||e(s)?"#FF4949":"",size:e(n)||e(o)||e(s)?"44":"60",component:e(n)||e(o)||e(s)?e(nt):e(Ee)},null,8,["color","size","component"])]),_:1},8,["disabled"])]))}});const dt=D(ct,[["__scopeId","data-v-b8650dcf"]]),ut=h({__name:"MenuButtons",setup(t){const{smallResolution:r}=ve();return(n,l)=>(_(),R(e(S),{justify:e(r)?"center":"space-between","wrap-item":!0,wrap:!0,size:20},{default:c(()=>[i(e(A),{class:"menu-button",tag:"a",text:"",href:"/settings",target:"_self",type:"primary"},{default:c(()=>[M(g(n.$t("history.title")),1)]),_:1}),i(e(A),{class:"menu-button",text:"",tag:"a",href:"/history",target:"_self",type:"primary"},{default:c(()=>[M(g(n.$t("session.title")),1)]),_:1})]),_:1},8,["justify"]))}});const pt=D(ut,[["__scopeId","data-v-9fe8a32b"]]),mt={class:"program-item__index"},_t=h({__name:"ProgramItem",props:{item:{},active:{type:Boolean},index:{}},setup(t){const{openProgramEdit:r,deleteProgram:n}=I(),{isAdmin:l}=ae();return(o,s)=>(_(),R(e(fe),{class:oe(o.active?"active-program":"")},{default:c(()=>[i(e(S),{class:"program-item",justify:"start",size:"small","wrap-item":!1},{default:c(()=>[p("span",mt,g(o.index),1),i(e(ye),{style:{"max-width":"150px"},"line-clamp":1},{default:c(()=>[M(g(o.item.name),1)]),_:1})]),_:1}),e(l)?(_(),R(e(A),{key:0,circle:"",size:"small",class:"edit-button",onClick:s[0]||(s[0]=U(m=>e(r)(o.item.id),["stop","prevent"]))},{default:c(()=>[i(e(T),{component:e(Ke)},null,8,["component"])]),_:1})):V("",!0),e(l)?(_(),R(e(A),{key:1,circle:"",size:"small",class:"delete-button",onClick:s[1]||(s[1]=U(m=>e(n)(o.item.id),["stop","prevent"]))},{default:c(()=>[i(e(T),{component:e(Je)},null,8,["component"])]),_:1})):V("",!0)]),_:1},8,["class"]))}});const vt=D(_t,[["__scopeId","data-v-828c6299"]]),ft=h({__name:"ProgramList",setup(t){const{isAdmin:r}=ae(),{programs:n,isActive:l,setActiveById:o,openProgramCreation:s,fetchPrograms:m}=I();return se(async()=>{await m()}),(v,a)=>(_(),C("div",null,[i(e(S),{size:"large",justify:"center"},{default:c(()=>[p("h3",null,g(v.$t("program.title")),1)]),_:1}),i(e(S),{vertical:"",size:"large"},{default:c(()=>[i(e(ze),{"has-sider":"","native-scrollbar":!1,style:{height:"400px"}},{default:c(()=>[i(e(ke),{"collapsed-width":0,"content-style":"padding-top: 24px; padding-right: 15px"},{default:c(()=>[(_(!0),C(ne,null,he(e(n),(d,u)=>(_(),R(vt,{item:d,key:u,index:u,style:{"margin-bottom":"10px",cursor:"pointer"},active:e(l)(d.id),onClick:f=>e(o)(d.id)},null,8,["item","index","active","onClick"]))),128))]),_:1})]),_:1}),e(r)?(_(),R(e(A),{key:0,size:"small",class:"create-button",onClick:a[0]||(a[0]=d=>e(s)())},{default:c(()=>[i(e(S),{justify:"space-around",align:"center","wrap-item":!1},{default:c(()=>[i(e(T),{component:e(Ce)},null,8,["component"]),p("span",null,g(v.$t("program.create")),1)]),_:1})]),_:1})):V("",!0)]),_:1})]))}});const ht=D(ft,[["__scopeId","data-v-c3f79ba7"]]),kt=h({__name:"Main",setup(t){return(r,n)=>(_(),R(e(Re),{cols:"1 s:1 m:3 l:3 xl:3 2xl:3","x-gap":"20","y-gap":"40","item-responsive":"",responsive:"screen"},{default:c(()=>[i(e(K),{span:"2 m:2 l:2 xl:2 2xl:2"},{default:c(()=>[i(Ie),i(dt),i(pt)]),_:1}),i(e(K),{span:"1"},{default:c(()=>[i(ht)]),_:1})]),_:1}))}});export{kt as default};
