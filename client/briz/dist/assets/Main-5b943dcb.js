import{c as oe,a as Y,d as v,u as se,b as j,e as k,f as ae,h as R,t as le,g as L,i as fe,r as g,j as he,k as ge,B as E,A as I,o as p,l as y,m as d,n as w,p as e,q as x,w as c,s as P,N as b,v as H,x as i,y as re,F as ie,z as we,C as ce,D as de,E as xe,G as Q,H as ye,U as F,I as be,J as X}from"./index-934ffed8.js";import{u as Ce,a as $e,N as ze}from"./base-data.service-5f69f099.js";import{P as Ae,N as ke,A as Re}from"./Add12Regular-d4692a7c.js";import{p as Me,N as Be}from"./index-59fc06b6.js";import{_ as S,N as M}from"./_plugin-vue_export-helper-3630f323.js";import{N,a as Ne,b as Pe}from"./LayoutContent-135e8955.js";import{N as Z,a as Se}from"./Grid-ce356153.js";import"./next-frame-once-7035a838.js";const Te=oe("p",`
 box-sizing: border-box;
 transition: color .3s var(--n-bezier);
 margin: var(--n-margin);
 font-size: var(--n-font-size);
 line-height: var(--n-line-height);
 color: var(--n-text-color);
`,[Y("&:first-child","margin-top: 0;"),Y("&:last-child","margin-bottom: 0;")]),De=Object.assign(Object.assign({},j.props),{depth:[String,Number]}),Ie=v({name:"P",props:De,setup(t){const{mergedClsPrefixRef:o,inlineThemeDisabled:n}=se(t),r=j("Typography","-p",Te,le,t,o),a=k(()=>{const{depth:u}=t,f=u||"1",{common:{cubicBezierEaseInOut:l},self:{pFontSize:m,pLineHeight:_,pMargin:h,pTextColor:z,[`pTextColor${f}Depth`]:C}}=r.value;return{"--n-bezier":l,"--n-font-size":m,"--n-line-height":_,"--n-margin":h,"--n-text-color":u===void 0?z:C}}),s=n?ae("p",k(()=>`${t.depth||""}`),a,t):void 0;return{mergedClsPrefix:o,cssVars:n?void 0:a,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var t;return(t=this.onRender)===null||t===void 0||t.call(this),R("p",{class:[`${this.mergedClsPrefix}-p`,this.themeClass],style:this.cssVars},this.$slots)}}),Oe=oe("text",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[L("strong",`
 font-weight: var(--n-font-weight-strong);
 `),L("italic",{fontStyle:"italic"}),L("underline",{textDecoration:"underline"}),L("code",`
 line-height: 1.4;
 display: inline-block;
 font-family: var(--n-font-famliy-mono);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 box-sizing: border-box;
 padding: .05em .35em 0 .35em;
 border-radius: var(--n-code-border-radius);
 font-size: .9em;
 color: var(--n-code-text-color);
 background-color: var(--n-code-color);
 border: var(--n-code-border);
 `)]),Le=Object.assign(Object.assign({},j.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),Ve=v({name:"Text",props:Le,setup(t){const{mergedClsPrefixRef:o,inlineThemeDisabled:n}=se(t),r=j("Typography","-text",Oe,le,t,o),a=k(()=>{const{depth:u,type:f}=t,l=f==="default"?u===void 0?"textColor":`textColor${u}Depth`:fe("textColor",f),{common:{fontWeightStrong:m,fontFamilyMono:_,cubicBezierEaseInOut:h},self:{codeTextColor:z,codeBorderRadius:C,codeColor:U,codeBorder:_e,[l]:ve}}=r.value;return{"--n-bezier":h,"--n-text-color":ve,"--n-font-weight-strong":m,"--n-font-famliy-mono":_,"--n-code-border-radius":C,"--n-code-text-color":z,"--n-code-color":U,"--n-code-border":_e}}),s=n?ae("text",k(()=>`${t.type[0]}${t.depth||""}`),a,t):void 0;return{mergedClsPrefix:o,compitableTag:Ce(t,["as","tag"]),cssVars:n?void 0:a,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var t,o,n;const{mergedClsPrefix:r}=this;(t=this.onRender)===null||t===void 0||t.call(this);const a=[`${r}-text`,this.themeClass,{[`${r}-text--code`]:this.code,[`${r}-text--delete`]:this.delete,[`${r}-text--strong`]:this.strong,[`${r}-text--italic`]:this.italic,[`${r}-text--underline`]:this.underline}],s=(n=(o=this.$slots).default)===null||n===void 0?void 0:n.call(o);return this.code?R("code",{class:a,style:this.cssVars},this.delete?R("del",null,s):s):this.delete?R("del",{class:a,style:this.cssVars},s):R(this.compitableTag||"span",{class:a,style:this.cssVars},s)}}),G=g(0),J=g([]),W=g(),$=g(),q=g(),B=g();function O(){const t=he();async function o(){const{data:l}=await $e(I.PROGRAMS);J.value=Me(Ae,l.value)||[]}function n(l){return!$.value||l===null?!1:$.value.id===l}function r(l){var m,_,h;$.value=JSON.parse(JSON.stringify(l)),B.value=JSON.parse(JSON.stringify((m=$.value)==null?void 0:m.actions)),G.value=B.value?B.value.reduce((z,C)=>z+C.duration,0):0,q.value=((_=$.value)==null?void 0:_.id)??void 0,W.value=(h=$.value)==null?void 0:h.description}function a(l){var m,_;l!==null&&l!==""&&(q.value=l,$.value=J.value.find(h=>h.id===l),B.value=(m=$.value)==null?void 0:m.actions,G.value=B.value?B.value.reduce((h,z)=>h+z.duration,0):0,W.value=(_=$.value)==null?void 0:_.description)}function s(){t.push({name:"create-program"}).then()}function u(l){l!==null&&t.push({name:"edit-program",params:{id:l}}).then()}function f(l){l!==null&&E.delete(I.PROGRAM(l)).then(()=>{o()})}return{programs:J,activeProgram:$,activeProgramId:q,programDescription:W,isActive:n,setActive:r,setActiveById:a,sessionPeriod:ge(G),openProgramCreation:s,openProgramEdit:u,deleteProgram:f,fetchPrograms:o}}const Ee={class:"main-wrapper"},He=v({__name:"MainDescription",setup(t){const o=g(!1),{programDescription:n}=O();return(r,a)=>(p(),y(ie,null,[d("div",Ee,[d("h2",null,w(r.$t("main.title")),1),d("div",null,[d("p",null,w(e(n)),1),e(n)?(p(),x(e(b),{key:0,size:"small",class:"display: span",text:"",quaternary:"",onClick:a[0]||(a[0]=s=>o.value=!0)},{default:c(()=>[P(w(r.$t("main.buttonTitle")),1)]),_:1})):H("",!0)])]),i(e(re),{show:o.value,"onUpdate:show":a[1]||(a[1]=s=>o.value=s),"mask-closable":!0,style:{width:"600px"},title:r.$t("main.title"),"aria-modal":"true",preset:"card"},{default:c(()=>[d("p",null,w(e(n)),1)]),_:1},8,["show","title"])],64))}});const je=S(He,[["__scopeId","data-v-8a45608d"]]),Fe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ue=d("g",{fill:"none"},[d("path",{d:"M8.628 14.982A1 1 0 0 1 7 14.204V5.797a1 1 0 0 1 1.628-.778l4.723 3.814a1.5 1.5 0 0 1 0 2.334l-4.723 3.815zM8 5.797v8.407l4.723-3.815a.5.5 0 0 0 0-.778L8 5.797z",fill:"currentColor"})],-1),Ge=[Ue],Je=v({name:"CaretRight20Regular",render:function(o,n){return p(),y("svg",Fe,Ge)}}),We={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},qe=d("g",{fill:"none"},[d("path",{d:"M6.5 7v4a.5.5 0 0 0 1 0V7a.5.5 0 0 0-1 0zM9 6.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5zM10 4h3a.5.5 0 0 1 0 1h-.553l-.752 6.776A2.5 2.5 0 0 1 9.21 14H6.79a2.5 2.5 0 0 1-2.485-2.224L3.552 5H3a.5.5 0 0 1 0-1h3a2 2 0 1 1 4 0zM8 3a1 1 0 0 0-1 1h2a1 1 0 0 0-1-1zM4.559 5l.74 6.666A1.5 1.5 0 0 0 6.79 13h2.42a1.5 1.5 0 0 0 1.49-1.334L11.442 5H4.56z",fill:"currentColor"})],-1),Ke=[qe],Ye=v({name:"Delete16Regular",render:function(o,n){return p(),y("svg",We,Ke)}}),Qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Xe=d("g",{fill:"none"},[d("path",{d:"M3 2.75C3 1.784 3.784 1 4.75 1h6.5c.966 0 1.75.784 1.75 1.75v3.457A5.5 5.5 0 0 0 7.257 15H4.75A1.75 1.75 0 0 1 3 13.25V2.75zM6 9a1 1 0 1 0 0-2a1 1 0 0 0 0 2zm5.5 7a4.5 4.5 0 1 0 0-9a4.5 4.5 0 0 0 0 9zm.354-2.146a.5.5 0 0 1-.708-.708L12.293 12H9.5a.5.5 0 0 1 0-1h2.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 .146.351v.006a.5.5 0 0 1-.144.348l-.003.003l-2 2z",fill:"currentColor"})],-1),Ze=[Xe],et=v({name:"DoorArrowRight16Filled",render:function(o,n){return p(),y("svg",Qe,Ze)}}),tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},nt=d("g",{fill:"none"},[d("path",{d:"M13.416 2.584c.778.778.778 2.039 0 2.817L6.058 12.76c-.319.32-.719.546-1.156.655l-2.283.57a.498.498 0 0 1-.604-.603l.57-2.283a2.49 2.49 0 0 1 .656-1.156l7.358-7.358a1.992 1.992 0 0 1 2.817 0zM9.894 4.697l-5.949 5.949a1.495 1.495 0 0 0-.393.694l-.369 1.477l1.477-.37c.263-.065.503-.2.694-.392l5.949-5.95l-1.409-1.408zm1.41-1.41l-.705.705l1.408 1.409l.705-.704a.996.996 0 0 0-1.409-1.41z",fill:"currentColor"})],-1),ot=[nt],st=v({name:"Edit16Regular",render:function(o,n){return p(),y("svg",tt,ot)}}),at={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},lt=d("g",{fill:"none"},[d("path",{d:"M7.5 11.5v.5a.5.5 0 0 1-.5.5H6v.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1.293A1 1 0 0 1 2.293 11l3.87-3.87A4 4 0 1 1 10 10H8.999v1a.5.5 0 0 1-.5.5h-1zM11 6a1 1 0 1 0 0-2a1 1 0 0 0 0 2z",fill:"currentColor"})],-1),rt=[lt],it=v({name:"Key16Filled",render:function(o,n){return p(),y("svg",at,rt)}}),ct={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48"},dt=d("g",{fill:"none"},[d("path",{d:"M17.75 7A3.25 3.25 0 0 1 21 10.25v27.5A3.25 3.25 0 0 1 17.75 41h-5.5A3.25 3.25 0 0 1 9 37.75v-27.5A3.25 3.25 0 0 1 12.25 7h5.5zm18 0A3.25 3.25 0 0 1 39 10.25v27.5A3.25 3.25 0 0 1 35.75 41h-5.5A3.25 3.25 0 0 1 27 37.75v-27.5A3.25 3.25 0 0 1 30.25 7h5.5zm-18 2.5h-5.5a.75.75 0 0 0-.75.75v27.5c0 .414.336.75.75.75h5.5a.75.75 0 0 0 .75-.75v-27.5a.75.75 0 0 0-.75-.75zm18 0h-5.5a.75.75 0 0 0-.75.75v27.5c0 .414.336.75.75.75h5.5a.75.75 0 0 0 .75-.75v-27.5a.75.75 0 0 0-.75-.75z",fill:"currentColor"})],-1),ut=[dt],pt=v({name:"Pause48Regular",render:function(o,n){return p(),y("svg",ct,ut)}}),mt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},_t=d("g",{fill:"none"},[d("path",{d:"M15.5 4a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5h11zm-11-1A1.5 1.5 0 0 0 3 4.5v11A1.5 1.5 0 0 0 4.5 17h11a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 15.5 3h-11z",fill:"currentColor"})],-1),vt=[_t],ft=v({name:"Stop20Regular",render:function(o,n){return p(),y("svg",mt,vt)}});var D=(t=>(t.pause="pause",t.resume="resume",t.run="run",t.stop="stop",t))(D||{});const A=g("stop"),ee=g();function ue(){const t=({hours:l,minutes:m,seconds:_})=>[R("span",{style:"display: none;"},l),R("span",{style:"display: inline-block; font-weight: bold"},m),":",R("span",{style:"display: inline-block; font-weight: bold"},_)],o=k(()=>A.value==="run"),n=k(()=>A.value==="pause"),r=k(()=>A.value==="resume"),a=k(()=>A.value==="stop");function s(l,m){m!==void 0&&E.get(I.SET_STATE_BY_ID(l,m),{},void 0,"Ошибка при установке статуса").then(()=>{A.value=l,A.value==="stop"&&f()})}function u(l){A.value=l}function f(){var l;(l=ee.value)==null||l.reset()}return{state:A,setState:s,isActivated:o,isPaused:n,isResumed:r,isStopped:a,stateEnum:D,renderCountdown:t,handleReset:f,countdown:ee,setStateWebsocket:u}}var pe=(t=>(t[t.paused=D.pause]="paused",t[t.stopped=D.stop]="stopped",t[t.running=D.run]="running",t))(pe||{});const T=g(),te=g(0),{setStateWebsocket:ht}=ue(),{setActiveById:gt,isActive:wt}=O();function xt(){const t=new WebSocket(we+"/status");return ce(()=>{t.onmessage=function(o){var n,r,a;T.value=JSON.parse(o.data),te.value=JSON.parse(o.data).elapsed_time,ht(pe[(n=T.value)==null?void 0:n.program_status]),gt((r=T.value)==null?void 0:r.program_id),wt((a=T.value)==null?void 0:a.program_id)}}),{websocketData:T,elapsedTime:te}}const yt={class:"wrapper-control"},bt={class:"title-control"},Ct=v({__name:"ControlSystem",setup(t){const{setState:o,isActivated:n,isStopped:r,isPaused:a,isResumed:s,stateEnum:u,renderCountdown:f,countdown:l}=ue(),{sessionPeriod:m,activeProgramId:_}=O(),{elapsedTime:h}=xt();return(z,C)=>(p(),y("div",yt,[i(e(b),{disabled:e(_)===void 0&&(!e(n)||e(r)),class:de(["btn-control",e(a)?"active":""]),onClick:C[0]||(C[0]=U=>e(o)(e(a)?e(u).resume:e(u).pause,e(_)))},{default:c(()=>[i(e(M),{size:"44",color:"#ddd",component:e(pt)},null,8,["component"])]),_:1},8,["disabled","class"]),d("div",bt,[i(e(Ie),{type:"default"},{default:c(()=>[P(w(z.$t("control.title")),1)]),_:1}),i(e(Ve),{type:e(n)?"error":"default",class:"timer",depth:"3"},{default:c(()=>[i(e(ke),{ref_key:"countdown",ref:l,duration:(e(m)-e(h))*1e3,active:!1,render:e(f)},null,8,["duration","render"])]),_:1},8,["type"])]),i(e(b),{disabled:e(_)===void 0,class:"btn-control",onClick:C[1]||(C[1]=U=>e(o)(e(n)||e(a)||e(s)?e(u).stop:e(u).run,e(_)))},{default:c(()=>[i(e(M),{color:e(n)||e(a)||e(s)?"#FF4949":"",size:e(n)||e(a)||e(s)?"44":"60",component:e(n)||e(a)||e(s)?e(ft):e(Je)},null,8,["color","size","component"])]),_:1},8,["disabled"])]))}});const $t=S(Ct,[["__scopeId","data-v-b8650dcf"]]),zt=v({__name:"MenuButtons",setup(t){const{smallResolution:o}=xe();return(n,r)=>(p(),x(e(N),{justify:e(o)?"center":"space-between","wrap-item":!0,wrap:!0,size:20},{default:c(()=>[i(e(b),{class:"menu-button",tag:"a",text:"",href:"/settings",target:"_self",type:"primary"},{default:c(()=>[P(w(n.$t("history.title")),1)]),_:1}),i(e(b),{class:"menu-button",text:"",tag:"a",href:"/history",target:"_self",type:"primary"},{default:c(()=>[P(w(n.$t("session.title")),1)]),_:1})]),_:1},8,["justify"]))}});const At=S(zt,[["__scopeId","data-v-9fe8a32b"]]),kt={class:"program-item__index"},Rt=v({__name:"ProgramItem",props:{item:{},active:{type:Boolean},index:{}},setup(t){const{openProgramEdit:o,deleteProgram:n}=O(),{isAdmin:r}=F();return(a,s)=>(p(),x(e(ye),{class:de(a.active?"active-program":"")},{default:c(()=>[i(e(N),{class:"program-item",justify:"start",size:"small","wrap-item":!1},{default:c(()=>[d("span",kt,w(a.index),1),i(e(ze),{style:{"max-width":"150px"},"line-clamp":1},{default:c(()=>[P(w(a.item.name),1)]),_:1})]),_:1}),e(r)?(p(),x(e(b),{key:0,circle:"",size:"small",class:"edit-button",onClick:s[0]||(s[0]=Q(u=>e(o)(a.item.id),["stop","prevent"]))},{default:c(()=>[i(e(M),{component:e(st)},null,8,["component"])]),_:1})):H("",!0),e(r)?(p(),x(e(b),{key:1,circle:"",size:"small",class:"delete-button",onClick:s[1]||(s[1]=Q(u=>e(n)(a.item.id),["stop","prevent"]))},{default:c(()=>[i(e(M),{component:e(Ye)},null,8,["component"])]),_:1})):H("",!0)]),_:1},8,["class"]))}});const Mt=S(Rt,[["__scopeId","data-v-828c6299"]]),{getAdminStatus:ne}=F(),V=g(!1),K=g();function me(){function t(){V.value=!V.value}function o(){K.value!==void 0&&E.post(I.LOGIN,{pin_code:K.value},void 0,"","Ошибка при входе").then(()=>{V.value=!1,ne()})}function n(){E.get(I.LOGOUT,{},void 0,"Ошибка при выходе").then(()=>{ne()})}return{showAdminModalRef:V,toggleAdminModal:t,loginAdmin:o,logoutAdmin:n,pinCode:K}}const Bt=v({__name:"AdminButton",setup(t){const{isAdmin:o}=F(),{toggleAdminModal:n,logoutAdmin:r}=me();return(a,s)=>e(o)?(p(),x(e(b),{key:0,quaternary:"",style:{display:"flex"},onClick:e(r)},{default:c(()=>[i(e(M),{size:"24",color:"#ddd",component:e(et)},null,8,["component"])]),_:1},8,["onClick"])):(p(),x(e(b),{key:1,quaternary:"",style:{display:"flex"},onClick:e(n)},{default:c(()=>[i(e(M),{size:"24",color:"#ddd",component:e(it)},null,8,["component"])]),_:1},8,["onClick"]))}}),Nt=v({__name:"ProgramList",setup(t){const{isAdmin:o}=F(),{programs:n,isActive:r,setActiveById:a,openProgramCreation:s,fetchPrograms:u}=O();return ce(async()=>{await u()}),(f,l)=>(p(),y("div",null,[i(e(N),{size:"large",justify:"center",align:"center"},{default:c(()=>[d("h3",null,w(f.$t("program.title")),1),i(Bt)]),_:1}),i(e(N),{vertical:"",size:"large"},{default:c(()=>[i(e(Ne),{"has-sider":"","native-scrollbar":!1,style:{height:"400px"}},{default:c(()=>[i(e(Pe),{"collapsed-width":0,"content-style":"padding-top: 24px; padding-right: 15px"},{default:c(()=>[(p(!0),y(ie,null,be(e(n),(m,_)=>(p(),x(Mt,{item:m,key:_,index:_,style:{"margin-bottom":"10px",cursor:"pointer"},active:e(r)(m.id),onClick:h=>e(a)(m.id)},null,8,["item","index","active","onClick"]))),128))]),_:1})]),_:1}),e(o)?(p(),x(e(b),{key:0,size:"small",class:"create-button",onClick:l[0]||(l[0]=m=>e(s)())},{default:c(()=>[i(e(N),{justify:"space-around",align:"center","wrap-item":!1},{default:c(()=>[i(e(M),{component:e(Re)},null,8,["component"]),d("span",null,w(f.$t("program.create")),1)]),_:1})]),_:1})):H("",!0)]),_:1})]))}});const Pt=S(Nt,[["__scopeId","data-v-1842f3b7"]]),St=v({__name:"AdminModal",setup(t){const{showAdminModalRef:o,loginAdmin:n,pinCode:r}=me();return(a,s)=>(p(),x(e(re),{show:e(o),"onUpdate:show":s[1]||(s[1]=u=>X(o)?o.value=u:null),"mask-closable":!0,style:{width:"600px"},title:a.$t("admin.title"),"aria-modal":"true",preset:"card"},{default:c(()=>[i(e(N),{size:"large",vertical:"",align:"center",justify:"center"},{default:c(()=>[i(e(Be),{value:e(r),"onUpdate:value":s[0]||(s[0]=u=>X(r)?r.value=u:null),type:"password","show-password-on":"click",class:"admin-password",autocomplete:"off",maxlength:10},null,8,["value"]),i(e(b),{quaternary:"",style:{display:"flex"},onClick:e(n)},{default:c(()=>[P(w(a.$t("admin.enter")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["show","title"]))}});const Tt=S(St,[["__scopeId","data-v-f520bdef"]]),Ft=v({__name:"Main",setup(t){return(o,n)=>(p(),x(e(Se),{cols:"1 s:1 m:3 l:3 xl:3 2xl:3","x-gap":"20","y-gap":"40","item-responsive":"",responsive:"screen"},{default:c(()=>[i(e(Z),{span:"2 m:2 l:2 xl:2 2xl:2"},{default:c(()=>[i(je),i($t),i(At)]),_:1}),i(e(Z),{span:"1"},{default:c(()=>[i(Pt),i(Tt)]),_:1})]),_:1}))}});export{Ft as default};
